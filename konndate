#!/usr/bin/python3
# SPDX-FileCopyrightText: 2025 Yoshiaki Naruse <zhengyit364@gmail.com>
# SPDX-License-Identifier: BSD-3-Clause

import sys

prog = sys.argv[0]

if len(sys.argv) == 2 and sys.argv[1] in ("-h", "--help"):
    print(f"使い方: {prog} <ジャンル1> <ジャンル2> <ジャンル3>")
    print("  <ジャンル1>: 肉 / 魚 / 麺")
    print("  <ジャンル2>: 例) 焼く, 煮る, 揚げる, 丼 など")
    print("  <ジャンル3>: 例) 牛, 豚, 鳥 など")
    print()
    print(f"  例: {prog} 肉 焼く 牛")
    sys.exit(0)

if len(sys.argv) != 4:
    print("Error: 引数の数が違います。", file=sys.stderr)
    print(f"使い方: {prog} <ジャンル1> <ジャンル2> <ジャンル3>")
    print("  <ジャンル1>: 肉 / 魚 / 麺")
    print("  <ジャンル2>: 例) 焼く, 煮る, 揚げる, 丼 など")
    print("  <ジャンル3>: 例) 牛, 豚, 鳥 など")
    print()
    print(f"  例: {prog} 肉 焼く 牛")
    sys.exit(1)

genre1 = sys.argv[1]
genre2 = sys.argv[2]
genre3 = sys.argv[3]

if genre1 == "肉":
    filename = "foods-肉.txt"
elif genre1 == "魚":
    filename = "foods-魚.txt"
elif genre1 == "麺":
    filename = "foods-麺.txt"
else:
    print(f"Error: 未対応のジャンル1 '{genre1}'", file=sys.stderr)
    sys.exit(2)

try:
    f = open(filename, encoding="utf-8")
except OSError:
    print(f"Error: ファイル {filename} を開けませんでした。", file=sys.stderr)
    sys.exit(3)

found = False

for line in f:
    line = line.strip()
    if not line or line.startswith("#"):
        continue

    try:
        left, name = line.split(":", 1)
        file_g3, file_g2 = left.split(",", 1)
    except ValueError:
        continue

    file_g2 = file_g2.strip()
    file_g3 = file_g3.strip()
    name = name.strip()

    if file_g2 == genre2 and file_g3 == genre3:
        print(name)
        found = True

f.close()

if not found:
    print(f"Error: {genre1}, {genre2}, {genre3} なし", file=sys.stderr)
    sys.exit(4)

sys.exit(0)

